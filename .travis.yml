language: node_js
node_js:
  - "11.9.0"
services: 
- postgres

script:
  - yarn run build
  - yarn test
  - yarn run coverage

before_install:
  - npm i -g babel-preset-env mocha chai babel-cli istanbul coveralls pg yarn

before_script:
  - psql -c 'create database  ireporter;' -U postgres

after_script:
  - ./node_modules/coveralls/bin/coveralls.js < ./coverage/lcov.info  && npm run clean
